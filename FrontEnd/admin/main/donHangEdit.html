<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from www.multipurposethemes.com/admin/eduadmin-template/bs5/main/tables_color.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 May 2021 08:13:01 GMT -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="https://www.multipurposethemes.com/admin/eduadmin-template/bs5/images/favicon.ico">

    <title>Trang chỉnh sửa đơn hàng</title>

    <!-- Vendors Style-->
    <link rel="stylesheet" href="css/vendors_css.css">

    <!-- Style-->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/skin_color.css">

</head>

<body class="hold-transition light-skin sidebar-mini theme-primary fixed">

    <div class="wrapper">
        <div id="loader"></div>

        <header class="main-header">
            <div class="d-flex align-items-center logo-box justify-content-start">
                <a href="#"
                    class="waves-effect waves-light nav-link d-none d-md-inline-block mx-10 push-btn bg-transparent"
                    data-toggle="push-menu" role="button">
                    <span class="icon-Align-left"><span class="path1"></span><span class="path2"></span><span
                            class="path3"></span></span>
                </a>
                <!-- Logo -->
                <a href="index.html" class="logo">
                    <!-- logo-->
                    <div class="logo-lg">
                        <span class="light-logo" style="background-color: #a9001b;"><img
                                style="width:90%; padding-left: 16px;" src="../images/img/logo.png" alt="logo"></span>
                        <span class="dark-logo"><img src="../images/logo-light-text.png" alt="logo"></span>
                    </div>
                </a>
            </div>
            <!-- Header Navbar -->
            <nav class="navbar navbar-static-top">
				<!-- Sidebar toggle button-->
				<div class="app-menu">
					<ul class="header-megamenu nav">
						<li class="btn-group nav-item d-md-none">
							<a href="#" class="waves-effect waves-light nav-link push-btn" data-toggle="push-menu"
								role="button">
								<span class="icon-Align-left"><span class="path1"></span><span
										class="path2"></span><span class="path3"></span></span>
							</a>
						</li>
						<li class="btn-group nav-item d-none d-xl-inline-block">
							<a href="contact_app_chat.html" class="waves-effect waves-light nav-link svg-bt-icon"
								title="Chat">
								<i class="icon-Chat"><span class="path1"></span><span class="path2"></span></i>
							</a>
						</li>
						<li class="btn-group nav-item d-none d-xl-inline-block">
							<a href="mailbox.html" class="waves-effect waves-light nav-link svg-bt-icon"
								title="Mailbox">
								<i class="icon-Mailbox"><span class="path1"></span><span class="path2"></span></i>
							</a>
						</li>
						<li class="btn-group nav-item d-none d-xl-inline-block">
							<a href="extra_taskboard.html" class="waves-effect waves-light nav-link svg-bt-icon"
								title="Taskboard">
								<i class="icon-Clipboard-check"><span class="path1"></span><span
										class="path2"></span><span class="path3"></span></i>
							</a>
						</li>
					</ul>
				</div>

				<div class="navbar-custom-menu r-side">
					<ul class="nav navbar-nav">
						<li class="btn-group nav-item d-lg-inline-flex d-none">
							<a href="#" data-provide="fullscreen" class="waves-effect waves-light nav-link full-screen"
								title="Full Screen">
								<i class="icon-Expand-arrows"><span class="path1"></span><span class="path2"></span></i>
							</a>
						</li>
						
						<!-- Notifications -->
						<li class="dropdown notifications-menu">
							<a href="#" class="waves-effect waves-light dropdown-toggle" data-bs-toggle="dropdown"
								title="Notifications">
								<i class="icon-Notifications"><span class="path1"></span><span class="path2"></span></i>
							</a>
							
						</li>

						<!-- User Account-->
						<li class="dropdown user user-menu">
							<a href="#" class="waves-effect waves-light dropdown-toggle" data-bs-toggle="dropdown"
								title="User">
								<i class="icon-User"><span class="path1"></span><span class="path2"></span></i>
							</a>
							<ul class="dropdown-menu animated flipInX">
								<li class="user-body">
									<a class="dropdown-item" href="#"><i class="ti-user text-muted me-2"></i>
										Thông tin cá nhân</a>
									<a class="dropdown-item" href="#"><i class="ti-settings text-muted me-2"></i>
										Cài đặt</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item" href="#"><i class="ti-lock text-muted me-2"></i> Đăng xuất</a>
								</li>
							</ul>
						</li>

						<!-- Control Sidebar Toggle Button -->
						<li>
							<a href="#" data-toggle="control-sidebar" title="Setting" class="waves-effect waves-light">
								<i class="icon-Settings"><span class="path1"></span><span class="path2"></span></i>
							</a>
						</li>

					</ul>
				</div>
			</nav>
		</header>

		<!-- Left side column. contains the logo and sidebar -->
		<aside class="main-sidebar">
			<!-- sidebar-->
			<section class="sidebar position-relative">
				<div class="multinav">
					<div class="multinav-scroll" style="height: 100%;">
						<div style="padding-left: 40px;  padding-top: 20px;"><img style="width: 45px; border-radius: 50px;" src="../images/avatar/user2.jpg" alt="..."><span style="padding-left: 5px;">Thảo Nguyễn</span></div>
						<!-- sidebar menu-->
						<ul class="sidebar-menu" data-widget="tree">
							<li class="header">Thanh điều hướng</li>
							<li class="treeview">
								<a href="/main/category.html">
									<i span class="icon-Layout-grid"><span class="path1"></span><span
											class="path2"></span></i>
									<span>Quản lý danh mục</span>
									<span class="pull-right-container">
										<i class="fa fa-angle-right pull-right"></i>
									</span>
								</a>
								<ul class="treeview-menu">
									<li><a href="/main/category.html"><i class="icon-Commit"><span
													class="path1"></span><span class="path2"></span></i>Danh sách danh
											mục</a></li>
									<li><a href="/main/categoryadd.html"><i class="icon-Commit"><span
													class="path1"></span><span class="path2"></span></i>Thêm danh
											mục</a></li>
								</ul>
							</li>
							<li class="treeview">
								<a href="/main/product.html">
									<i span class="icon-Layout-grid"><span class="path1"></span><span
											class="path2"></span></i>
									<span>Quản lý sản phẩm</span>
									<span class="pull-right-container">
										<i class="fa fa-angle-right pull-right"></i>
									</span>
								</a>
								<ul class="treeview-menu">
									<li><a href="/main/product.html"><i class="icon-Commit"><span
													class="path1"></span><span class="path2"></span></i>Danh sách sản
											phẩm</a></li>
									<li><a href="/main/Productadd.html"><i class="icon-Commit"><span
													class="path1"></span><span class="path2"></span></i>Thêm sản phẩm
											mới</a></li>
								</ul>
							</li>
							<li class="treeview">
								<a href="/main/donHang.html">
									<i span class="icon-Layout-grid"><span class="path1"></span><span
											class="path2"></span></i>
									<span>Quản lý đơn hàng</span>
									<span class="pull-right-container">
										<i class="fa fa-angle-right pull-right"></i>
									</span>
								</a>
								<ul class="treeview-menu">
									<li><a href="/main/donHang.html?status=0"><i class="icon-Commit"><span
													class="path1"></span><span class="path2"></span></i>Đơn hàng chưa xác thực</a></li>
									<li><a href="/main/donHang.html?status=1"><i class="icon-Commit"><span
													class="path1"></span><span class="path2"></span></i>Đơn hàng đã xác thực</a></li>
									<li><a href="/main/donHang.html?status=2"><i class="icon-Commit"><span
													class="path1"></span><span class="path2"></span></i>Đơn hàng đang giao</a></li>
									<li><a href="/main/donHang.html?status=3"><i class="icon-Commit"><span
													class="path1"></span><span class="path2"></span></i>Đơn hàng hoàn tất</a></li>
								</ul>
							</li>
							<li class="treeview">
								<a href="/main/user.html">
									<i span class="icon-Layout-grid"><span class="path1"></span><span
											class="path2"></span></i>
									<span>Quản lý người dùng</span>
									<span class="pull-right-container">
										<i class="fa fa-angle-right pull-right"></i>
									</span>
								</a>
								<ul class="treeview-menu">
									<li><a href="/main/user.html"><i class="icon-Commit"><span class="path1"></span><span
													class="path2"></span></i>Danh sách người dùng</a></li>
									<li><a href="/main/useradd.html"><i class="icon-Commit"><span class="path1"></span><span
													class="path2"></span></i>Thêm người dùng</a></li>
								</ul>
							</li>
							<li class="treeview">
								<a href="#">
									<i span class="icon-Layout-grid"><span class="path1"></span><span
											class="path2"></span></i>
									<span>Thống kê</span>
								</a>
							</li>
						</ul>
					</div>
				</div>
			</section>
			<div class="sidebar-footer">
				<a href="javascript:void(0)" class="link" data-bs-toggle="tooltip" title="Settings"><span
						class="icon-Settings-2"></span></a>
				<a href="mailbox.html" class="link" data-bs-toggle="tooltip" title="Email"><span
						class="icon-Mail"></span></a>
				<a href="javascript:void(0)" class="link" data-bs-toggle="tooltip" title="Logout"><span
						class="icon-Lock-overturning"><span class="path1"></span><span class="path2"></span></span></a>
			</div>
		</aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <div class="container-full">
                <!-- Content Header (Page header) -->
                <div class="content-header">
                    <div class="d-flex align-items-center">
                        <div class="me-auto">
                            <h3 class="page-title">CHI TIẾT ĐƠN HÀNG</h3>
                            <div class="d-inline-block align-items-center">
                                <nav>
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="#"><i class="mdi mdi-home-outline"></i></a>
                                        </li>
                                        <li class="breadcrumb-item" aria-current="page">Quản lý đơn hàng</li>
                                        <li class="breadcrumb-item active" aria-current="page">Chi tiết đơn hàng</li>
                                    </ol>
                                </nav>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Main content -->
                <section class="content">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="box">
                                <div class="box-body">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead class="bg-primary">
                                                <tr>
                                                    <th>#</th>
                                                    <th>Tên thực đơn</th>
                                                    <th>Hình ảnh</th>
                                                    <th>Số lượng</th>
                                                    <th>Tổng tiền</th>
                                                    <th>Thao tác</th>
                                                </tr>
                                            </thead>
                                            <tbody id="item">
                                                <tr>
                                                    <td>1</td>
                                                    <td><a href="#"></a></td>
                                                    <td>Eichmann</td>
                                                    <td>@Sonu</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <nav aria-label="Page navigation example">
                        <ul class="pagination" id="pageList">

                        </ul>
                    </nav>
                    <select class="sp"></select>
                    <button id="add" type="button"
                        class="waves-effect waves-light btn mb-5 bg-gradient-primary">Thêm</button>

                    <button id="submitBnt" type="button"
                        class="waves-effect waves-light btn mb-5 bg-gradient-primary">Cập nhật</button>

                </section>
                <!-- /.content -->
            </div>
        </div>
        <!-- /.content-wrapper -->

        <footer class="main-footer">
            <div class="pull-right d-none d-sm-inline-block">
                <ul class="nav nav-primary nav-dotted nav-dot-separated justify-content-center justify-content-md-end">
                    <li class="nav-item">
                        <a class="nav-link" href="javascript:void(0)">PIZZA</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Mua ngay</a>
                    </li>
                </ul>
            </div>
            &copy; 2021_nththaoo</a>. Đã đăng ký bản quyền.
        </footer>
        
        <!-- Add the sidebar's background. This div must be placed immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>
    </div>
    <!-- ./wrapper -->



    <!-- Page Content overlay -->


    <!-- Vendor JS -->
    <script src="js/vendors.min.js"></script>
    <script src="js/pages/chat-popup.js"></script>
    <script src="../assets/icons/feather-icons/feather.min.js"></script>

    <!-- EduAdmin App -->
    <script src="js/template.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <link href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet">


    <script>
        var id = location.search.slice(1).split("&")[0].split("=")[1];
        var html = "";
        $.ajax({
            type: "get",
            url: "https://localhost:44334/api/HoaDon/get-orderDetail/" + id,

            success: function (data) {
                //var html = "";
                console.log(data[0])


                for (var i = 1; i < data.length + 1; i++) {
                    var price = new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(data[i - 1].total);

                    html += '<tr>\
								<td>'+ i + '</td>\
                                <td id="name">' + data[i - 1].orderDetail_Name + '</td>\
                                <td class="img"><img  style="max-width: 7rem;" class="img-bordered-sm rounded-circle" src="'+ data[i - 1].image + '" alt="user image"></td>\
                                <td> <input id-detail="' + data[i - 1].orderDetail_ID + '" type="number" value="' + data[i - 1].quantity + '"></td>\
                                <td style="color:#e73c0bdb;" price="' + data[i - 1].total + '" class="total">' + price + '</td>\
								<td><span style="cursor: pointer;"  onclick="delete_o($(this))" class="badge badge-pill badge-danger"><a >Xóa</a></span>\
							</tr>'
                }
                $("#item").html(html);
            },
            error: function (e) {
                console.log(e)
            }
        })

        $.ajax({
            method: "get",
            url: "https://localhost:44334/api/Item/get-all",
            success: function (e) {
                console.log(e)
                var s = "";
                for (let index = 0; index < e.length; index++) {
                    const element = e[index];
                    s += "<option data-id='" + element.item_price + "' data-price='" + element.item_price + "' data-name='" + element.item_name + "' data-img='" + element.item_image + "'>" + element.item_name + "</option>"
                }
                $("select.sp").html(s);
            },
            error: function (e) {
                console.log(e)
            }
        })
        $("#add").click(function () {
            var a = $("select.sp :selected")
            var k = "";
            var price = new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(a.data("price"));
            k += '<tr>\
				<td></td>\
                <td proid="" id="name">' + a.data("name") + '</td>\
                <td class="img"><img  style="max-width: 7rem;" class="img-bordered-sm rounded-circle" src="' + a.data("img") + '" alt="user image"></td>\
                <td> <input id-detail="' + id + '" type="number" value="1"></td>\
                <td style="color:#e73c0bdb;" price="' + a.data("price") + '" class="total">' + price + '</td>\
				<td><span style="cursor: pointer;"  onclick="delete_o($(this))" class="badge badge-pill badge-danger"><a >Xóa</a></span>\
				</tr>'				
            $("#item").append(k);
        })
        function delete_o(e) {
            e.parents().eq(1).remove()
        }

        $("#submitBnt").click(function () {
            var model = [];
            $("table.table #item tr").each(function () {

                var k = {
                    "OrderDetail_ID": $(this).find("td input").attr("id-detail"),
                    "Quantity": $(this).find("td input").val(),
                    "OrderDetail_OrderID": id,
                    "OrderDetail_Name": $(this).find("td#name").html(),
                    "image": $(this).find("td.img img").attr("src"),
                    "total": $(this).find("td.total").attr("price")
                }
                model.push(k)
            });
            console.log(JSON.stringify(model))
            $.ajax({
                type: "POST",
                url: "https://localhost:44334/api/HoaDon/update-hoa-don",
                data: JSON.stringify(model),
                dataType: "json",
                contentType: 'application/json; charset=utf-8',

                success: function (data) {
                    console.log(data)
                    toastr.success("cập nhật đơn hàng thành công")
                },
                error: function (e) {
                    console.log(e)

                }
            })
        })
    </script>
    <link href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet">
</body>

<!-- Mirrored from www.multipurposethemes.com/admin/eduadmin-template/bs5/main/tables_color.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 May 2021 08:13:01 GMT -->

</html>